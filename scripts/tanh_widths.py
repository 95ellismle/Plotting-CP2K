#!/usr/bin/env python2
# -*- coding: utf-8 -*-
"""
Created on Mon Nov 12 18:28:54 2018

@author: mellis
"""

import matplotlib.pyplot as plt
import numpy as np

tanh_widths = {0.0003: [0,
  1e-06,
  2.5e-06,
  4e-06,
  5.5e-06,
  7e-06,
  8.5e-06,
  1e-05,
  4e-05,
  7e-05,
  0.0001,
  0.00025,
  0.00055,
  0.00085,
  0.001,
  0.0025,
  0.0055,
  0.0085,
  0.01,
  0.025,
  0.055,
  0.085,
  0.1,
  0.25,
  0.55,
  0.85,
  5.5e-05,
  8.5e-05,
  0.0004,
  0.0007,
  0.004,
  0.007,
  0.04,
  0.07,
  0.4,
  0.7,
  2.5e-05],
 0.003: [5.5e-06,
  7e-06,
  1e-05,
  4e-05,
  7e-05,
  0.0001,
  0.00025,
  0.00055,
  0.00085,
  0.001,
  0.0025,
  0.0055,
  0.0085,
  0.01,
  0.025,
  0.055,
  0.085,
  0.1,
  0.25,
  0.55,
  0.85,
  5.5e-05,
  0.0004,
  0.0007,
  0.004,
  0.007,
  0.04,
  0.07,
  0.4,
  0.7,
  0,
  1e-06,
  8.5e-05,
  2.5e-06,
  4e-06,
  8.5e-06,
  2.5e-05],
 0.03: [1e-06,
  2.5e-06,
  4e-06,
  5.5e-06,
  7e-06,
  8.5e-06,
  1e-05,
  4e-05,
  7e-05,
  0.0001,
  0.00025,
  0.00055,
  0.00085,
  0.001,
  0.0025,
  0.025,
  0.055,
  0,
  0.004,
  0.0055,
  0.0085,
  0.01,
  0.04,
  0.07,
  0.085,
  0.1,
  0.25,
  0.4,
  0.55,
  0.7,
  0.85,
  2.5e-05,
  5.5e-05,
  8.5e-05,
  0.0004,
  0.0007,
  0.007]}


drifts = {0.0003: [1.9362080815456714e-08,
  9.872541003044541e-07,
  7.898614689430671e-07,
  1.0089924940016645e-06,
  1.3151253939308283e-07,
  5.638274318427292e-07,
  7.806236333772536e-08,
  9.308582638520073e-08,
  4.1274440471497096e-06,
  3.464368764267522e-08,
  4.338091354202241e-07,
  6.928340378668756e-08,
  8.165472295241191e-09,
  4.685647481491188e-09,
  3.905821381213877e-09,
  8.346033548540741e-10,
  -4.451477732664698e-10,
  -8.365975226753882e-10,
  -9.801045683284153e-10,
  -1.5953907635116213e-09,
  -1.6808867144181756e-09,
  -1.6870977035587713e-09,
  -1.6836102396382799e-09,
  -1.6858817612345927e-09,
  -1.6826862139499344e-09,
  -1.6840872513426217e-09,
  1.276994934133037e-06,
  4.5595339849202587e-07,
  1.563877673521242e-08,
  5.83099646857933e-09,
  -5.235269348447141e-11,
  -6.695667238025852e-10,
  -1.6676968249194156e-09,
  -1.683497797394337e-09,
  -1.6828315907496493e-09,
  -1.6843564615310519e-09,
  2.1214704435565513e-07],
 0.003: [0.7207236361901498,
  0.5731932946043872,
  0.05805903734475043,
  0.00991079582950055,
  0.509479545206929,
  0.025047343651114353,
  0.11240949853531237,
  0.042538123408124295,
  0.06650060536514622,
  0.023034873052362494,
  0.005322915777295592,
  0.002982498271225648,
  0.0019660250929123047,
  0.0010178069848720773,
  0.0038757204826380355,
  0.0015658712799523219,
  0.0012444093187750738,
  0.002491571226685793,
  0.0003362287390601796,
  0.0002401256675787879,
  0.00027821372623835475,
  0.1342346020351858,
  0.10749687625816416,
  0.06393709095107544,
  0.004896766574522931,
  0.001018684651657,
  0.001529320270343544,
  0.00071430120518825,
  0.0005201053442722084,
  0.00010609950480568991,
  2.5865689173558453,
  0.01390329151157298,
  0.0007386480024664504,
  0.005477624581783406,
  0.010597204017264262,
  0.017941460174973504,
  0.07893872808143605],
 0.03: [1.0662093220893947,
  1.0303516720135155,
  0.25464814711000855,
  0.3749368779768341,
  0.30778114453451105,
  0.4373046806723334,
  0.2606720872427578,
  0.17823726738630333,
  0.05540847219921893,
  0.10129429799122262,
  0.05424607965313085,
  0.011810253400978651,
  0.0695907154302993,
  0.014922565945061025,
  0.01685950816305851,
  0.030284468624831768,
  0.05644688342014217,
  0.665596305876409,
  0.02792741250261005,
  0.02380117193144031,
  0.07285541941010056,
  0.018734730879752894,
  0.031125363431601584,
  0.04661645279583418,
  0.03675605480716117,
  0.036165996802197044,
  0.04106019979439334,
  0.04817609541740756,
  0.02503532462018677,
  0.061448944587260135,
  0.04146873460582554,
  0.18604663995869591,
  0.05512558752894434,
  0.1856674043111732,
  0.08137912248536061,
  0.013553096667686766,
  0.02399250711010169]}


couplings = {0.0003: [1.0347375772924006,
  1.034737614780312,
  1.0347380753113289,
  1.0347387822661434,
  1.0347379630330669,
  1.03473686060263,
  1.0347378526130286,
  1.0347373670646935,
  1.0347400280492751,
  1.0347378978310768,
  1.0347384582982702,
  1.0347379973612139,
  1.0347377737639034,
  1.0347377361577443,
  1.0347377220165581,
  1.0347376766837717,
  1.034737674918418,
  1.0347376713558543,
  1.0347376855326766,
  1.0347377163649434,
  1.0347377330028398,
  1.0347377242308766,
  1.0347377229107089,
  1.0347377203138388,
  1.0347377178919108,
  1.0347377220308671,
  1.0347390059174484,
  1.034738464690691,
  1.034737823840386,
  1.034737739631487,
  1.0347376777280273,
  1.0347376771840315,
  1.0347377199963501,
  1.0347377231582744,
  1.0347377082236375,
  1.0347377152853214,
  1.0347381571860415],
 0.003: [10.688531179773124,
  10.52655512451025,
  10.506571231729028,
  10.280818699156084,
  10.481544186868112,
  10.469037380161884,
  10.460074302359965,
  10.444939308618238,
  10.4301356200058,
  10.528205928348864,
  10.451785436350265,
  10.358127662798122,
  10.388015151181481,
  10.10706877489711,
  10.421739224785822,
  10.36933526270293,
  10.439317335306269,
  10.394235028583841,
  10.12582080509439,
  10.397466044554545,
  10.415175494565043,
  10.54300104310469,
  10.328960634771823,
  10.526680099578444,
  10.345737882488052,
  10.37847802386881,
  10.420326058600338,
  10.018042808835016,
  10.35664767688791,
  10.091590411270074,
  8.031231891897217,
  10.480244414546512,
  10.227652313646228,
  8.911860281437498,
  10.632772201434735,
  9.181390969390645,
  8.146574267671232],
 0.03: [132.409267139832,
  148.50205451739026,
  133.04823496063395,
  121.350487020042,
  129.81692226956906,
  102.7763182800234,
  140.19432012050396,
  121.67712838336367,
  140.39836790966402,
  144.18102851228778,
  134.7383680068973,
  138.1299648168883,
  133.83550258076892,
  137.20799167636636,
  132.65315745156286,
  120.41827475572242,
  54.88841651873263,
  100.0990551254087,
  117.5562439176124,
  127.75250678685059,
  30.24040774356937,
  129.21707289051662,
  122.42154579220653,
  32.00146751204145,
  103.71324362233766,
  5.744682020114156,
  100.26692918651923,
  121.45965323504377,
  114.52990636831235,
  107.22435816924767,
  96.15144070254868,
  141.80946403165683,
  139.5928973219178,
  132.89195127120888,
  134.76045477583443,
  132.04664203513948,
  121.22030120635237]}

#import pandas as pd
#0.03,
#0.0003, 
xlim = 0.015
f, a = plt.subplots(3)
rgb = ['r','g','b']
for i, key in enumerate([0.03, 0.003, 0.0003]):#drifts:
    window = 3
    x = tanh_widths[key] #pd.Series(tanh_widths[key]).rolling(window=window).mean()
    y = np.absolute(drifts[key])      #pd.Series(drifts[key]).rolling(window=window).mean()
    
    xy = np.array(sorted(zip(x,y)))
    x = xy[:,0]
    y = xy[:,1]
    
    a[i].plot(x, y, 'o', label=r"Coupling = %.2f meV"%(np.mean(couplings[key])), 
              color=rgb[i])
    a[i].set_title("")
    a[i].set_yscale("log")
    
    ytxt = np.max(y) - (np.max(y) - np.min(y))*0.2
    xtxt = xlim*0.7
    print(xtxt, ytxt)
    a[i].annotate(r"Coupling = %.2f meV"%(np.mean(couplings[key])), 
                     (xtxt, ytxt), fontsize=24)
    
    a[i].set_xlim([-0.001,xlim])
    if i < 2:
        a[i].tick_params(axis='x', labelbottom=False)

a[2].set_xlabel(r"Tanh Width [au$_f$]")
a[1].set_ylabel(r"Norm Drift [ps$^{-1}$]")

plt.subplots_adjust(top=0.945,
                    bottom=0.095,
                    left=0.075,
                    right=0.95,
                    hspace=0.134,
                    wspace=1.0)








